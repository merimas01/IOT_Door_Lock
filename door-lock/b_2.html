<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2</title>
    <style>
        #blink{
            width: 30px;
            height: 30px;
            border:solid;
        }
    </style>
</head>
<body>

    <div id="blink"></div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
       // TODO: Add SDKs for Firebase products that you want to use
       // https://firebase.google.com/docs/web/setup#available-libraries
   
       // Your web app's Firebase configuration
       const firebaseConfig = {
       apiKey: "AIzaSyAlL8kJB9eIqMCE1WOeSP03BeB4UlM92G4",
       authDomain: "smart-door-lock-3ce6d.firebaseapp.com",
       databaseURL: "https://smart-door-lock-3ce6d-default-rtdb.europe-west1.firebasedatabase.app",
       projectId: "smart-door-lock-3ce6d",
       storageBucket: "smart-door-lock-3ce6d.appspot.com",
       messagingSenderId: "15889009757",
       appId: "1:15889009757:web:6c7d06d2c3e5ed33b651b4"
       };
   
       // Initialize Firebase
       const app = initializeApp(firebaseConfig);

       import {getDatabase, set, get, update, remove, ref, child} 
       from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";


       const db = getDatabase();
       var counter=7;


       var reloadingInterval = setInterval(getBlinkanje, 8000);

       function getBlinkanje(){
        //prvo gettamo kliknuo_blink
        //ako je true onda ide odbrojavanje
        //nakon odbrojavanja kliknuo_blink se setuje na false

        const dbref=ref(db);
            get(child(dbref,"blinkanje/"+'kliknuo_blink'))
            .then((snapshot)=>{
                if(snapshot.exists())
                {
                    var data=snapshot.val();
                    if(data==true){
                        var tt2=setInterval(()=>
                        {
                            if(counter == 0) {                          
                                clearInterval(tt2);
                                counter=7;
                            } else if(counter%2==0 && counter!=0){
                                counter--;
                                document.getElementById('blink').style.background="red";
                            }
                            else{
                                counter--;
                                document.getElementById('blink').style.background="white";
                            }
                        },300);
                    }
                    setKliknuoBlinkFalse();
                }
              
            })

       }


       function setKliknuoBlinkFalse(){ 
        update(ref(db,'blinkanje'),{
                kliknuo_blink:false
            })
       }

   </script>
    
</body>
</html>